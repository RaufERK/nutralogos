#!/usr/bin/env tsx

/**
 * –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
 * –ó–∞–ø—É—Å–∫: npx tsx scripts/fix-duplicate-settings.ts
 */

import { getDatabase } from '../src/lib/database'

async function fixDuplicateSettings() {
  console.log('üîß –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏...')

  const database = await getDatabase()

  // 1. –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ content –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  console.log('\nüìã –£–¥–∞–ª—è–µ–º –¥—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è chunk –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ content...')

  const duplicatesToRemove = ['CHUNK_SIZE_TOKENS', 'CHUNK_OVERLAP_TOKENS']

  for (const param of duplicatesToRemove) {
    try {
      const result = database
        .prepare('DELETE FROM system_settings WHERE parameter_name = ?')
        .run(param)

      if (result.changes > 0) {
        console.log(`‚ùå –£–¥–∞–ª–µ–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞: ${param}`)
      }
    } catch (error) {
      console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ ${param}:`, error)
    }
  }

  // 2. –ü–µ—Ä–µ–Ω–æ—Å–∏–º use_mock –∏ system_prompt –≤ ai –∫–∞—Ç–µ–≥–æ—Ä–∏—é
  console.log('\nüìã –ü–µ—Ä–µ–Ω–æ—Å–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏...')

  const settingsToMove = [
    { param: 'use_mock', newCategory: 'ai', newOrder: 5 },
    { param: 'system_prompt', newCategory: 'ai', newOrder: 6 },
  ]

  for (const setting of settingsToMove) {
    try {
      const result = database
        .prepare(
          'UPDATE system_settings SET category = ?, ui_order = ? WHERE parameter_name = ?'
        )
        .run(setting.newCategory, setting.newOrder, setting.param)

      if (result.changes > 0) {
        console.log(
          `üîÑ –ü–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ${setting.param} –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ${setting.newCategory}`
        )
      }
    } catch (error) {
      console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–Ω–æ—Å–µ ${setting.param}:`, error)
    }
  }

  // 3. –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è
  console.log('\nüìã –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫...')

  const enhancedDescriptions = [
    {
      param: 'openai_chat_model',
      description:
        '–ú–æ–¥–µ–ª—å OpenAI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π',
      help_text:
        '–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å GPT –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤. GPT-4o - —Å–∞–º–∞—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –º–æ–¥–µ–ª—å —Å –ª—É—á—à–∏–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏, –Ω–æ –¥–æ—Ä–æ–∂–µ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏. GPT-3.5-turbo - –±—ã—Å—Ç—Ä–∞—è –∏ —ç–∫–æ–Ω–æ–º–∏—á–Ω–∞—è –º–æ–¥–µ–ª—å, –ø–æ–¥—Ö–æ–¥—è—â–∞—è –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–¥–∞—á. GPT-4-turbo - –∫–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É –∫–∞—á–µ—Å—Ç–≤–æ–º –∏ —Å–∫–æ—Ä–æ—Å—Ç—å—é.\n\n–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPT-4o –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤, GPT-3.5-turbo –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.',
    },
    {
      param: 'temperature',
      description:
        '–ü–∞—Ä–∞–º–µ—Ç—Ä –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö –º–æ–¥–µ–ª–∏ (–æ—Ç 0.0 –¥–æ 2.0)',
      help_text:
        '–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Å—Ç–µ–ø–µ–Ω—å —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –≤ –æ—Ç–≤–µ—Ç–∞—Ö AI. –ù–∏–∑–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (0.0-0.3) –¥–∞—é—Ç –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –∏ —Ç–æ—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, —Å–ª–µ–¥—É—è —Å—Ç—Ä–æ–≥–æ —Ñ–∞–∫—Ç–∞–º –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (0.4-0.7) –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–º –ø–æ–¥—Ö–æ–¥–æ–º. –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (0.8-2.0) —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å, –Ω–æ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –º–µ–Ω–µ–µ —Ç–æ—á–Ω—ã–º –∏–ª–∏ –¥–∞–∂–µ –≤—ã–¥—É–º–∞–Ω–Ω—ã–º –æ—Ç–≤–µ—Ç–∞–º.\n\n–î–ª—è –¥—É—Ö–æ–≤–Ω—ã—Ö –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 0.4-0.6 –¥–ª—è —Å–æ—á–µ—Ç–∞–Ω–∏—è –º—É–¥—Ä–æ—Å—Ç–∏ —Å —Ç–≤–æ—Ä—á–µ—Å–∫–∏–º –ø–æ–¥—Ö–æ–¥–æ–º.',
    },
    {
      param: 'max_tokens',
      description:
        '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ (—Å–ª–æ–≤/—Å–∏–º–≤–æ–ª–æ–≤) –≤ –æ—Ç–≤–µ—Ç–µ –º–æ–¥–µ–ª–∏',
      help_text:
        '–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–ª–∏–Ω—É –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ –æ—Ç–≤–µ—Ç–∞. –û–¥–∏–Ω —Ç–æ–∫–µ–Ω –ø—Ä–∏–º–µ—Ä–Ω–æ —Ä–∞–≤–µ–Ω 4 —Å–∏–º–≤–æ–ª–∞–º —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –∏–ª–∏ 0.75 –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —Å–ª–æ–≤–∞. –°–ª–∏—à–∫–æ–º –º–∞–ª–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (100-500) –º–æ–∂–µ—Ç –æ–±—Ä–µ–∑–∞—Ç—å –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (1500-4000) –ø–æ–∑–≤–æ–ª—è—é—Ç –¥–∞–≤–∞—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ, –Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.\n\n–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ –ø–æ–≤—ã—à–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤. –î–ª—è –¥—É—Ö–æ–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤, —Ç—Ä–µ–±—É—é—â–∏—Ö –≥–ª—É–±–æ–∫–∏—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 3000-4000 —Ç–æ–∫–µ–Ω–æ–≤.',
    },
    {
      param: 'retrieval_k',
      description:
        '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π',
      help_text:
        '–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–∫–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –±—É–¥–µ—Ç –Ω–∞–π–¥–µ–Ω–æ –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞. –ú–∞–ª—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (1-3) –¥–∞—é—Ç –±–æ–ª–µ–µ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∞–º—ã—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (4-8) –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å—é –∏ –ø–æ–ª–Ω–æ—Ç–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ë–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (9-20) —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –æ—Ö–≤–∞—Ç, –Ω–æ –º–æ–≥—É—Ç –≤–∫–ª—é—á–∞—Ç—å –º–µ–Ω–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.\n\n–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 6-8 –¥–ª—è –¥—É—Ö–æ–≤–Ω—ã—Ö —Ç–µ–º, –≥–¥–µ –≤–∞–∂–Ω–æ —É—á–µ—Å—Ç—å —Ä–∞–∑–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã –∏ —Ç—Ä–∞–¥–∏—Ü–∏–∏.',
    },
    {
      param: 'score_threshold',
      description:
        '–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Å—Ö–æ–¥—Å—Ç–≤–∞ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞',
      help_text:
        '–§–∏–ª—å—Ç—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ —Å—Ç–µ–ø–µ–Ω–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å—É. –ó–Ω–∞—á–µ–Ω–∏—è –æ—Ç 0.0 –¥–æ 1.0, –≥–¥–µ 1.0 - –ø–æ–ª–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ. –ù–∏–∑–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (0.1-0.3) –≤–∫–ª—é—á–∞—é—Ç –±–æ–ª—å—à–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –Ω–æ –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Å–ª–∞–±–æ —Å–≤—è–∑–∞–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (0.3-0.6) –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏. –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (0.7-0.9) –≤–∫–ª—é—á–∞—é—Ç —Ç–æ–ª—å–∫–æ –æ—á–µ–Ω—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –Ω–æ –º–æ–≥—É—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.\n\n–î–ª—è –¥—É—Ö–æ–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 0.3-0.5, —Ç–∞–∫ –∫–∞–∫ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ü–µ–ø—Ü–∏—è–º–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã–º–∏.',
    },
    {
      param: 'rerank_enabled',
      description:
        '–í–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
      help_text:
        '–ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∏—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏. –ü–æ—Å–ª–µ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –≤–µ–∫—Ç–æ—Ä–Ω–æ–º—É —Å—Ö–æ–¥—Å—Ç–≤—É —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è, —É—á–∏—Ç—ã–≤–∞—é—â–∏–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤—è–∑–∏, –∫–ª—é—á–µ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞.\n\n–ü–æ–≤—ã—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∏–ª–∏ –º–Ω–æ–≥–æ–∞—Å–ø–µ–∫—Ç–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤, –Ω–æ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞ –¥–µ—Ä–∂–∞—Ç—å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º.',
    },
    {
      param: 'spiritual_prompt_enabled',
      description:
        '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è –¥—É—Ö–æ–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤',
      help_text:
        '–ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è AI, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ —Ä–∞–±–æ—Ç—É —Å –¥—É—Ö–æ–≤–Ω—ã–º–∏, —Ñ–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–º–∏ –∏ –º–µ—Ç–∞—Ñ–∏–∑–∏—á–µ—Å–∫–∏–º–∏ —Ç–µ–º–∞–º–∏. –ü—Ä–æ–º–ø—Ç –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏—è, —É–≤–∞–∂–µ–Ω–∏—è –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º —Ç—Ä–∞–¥–∏—Ü–∏—è–º, –ø–æ–æ—â—Ä–µ–Ω–∏—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –¥—É—Ö–æ–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏ —ç—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.\n\n–ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ AI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–π –ø—Ä–æ–º–ø—Ç, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –º–µ–Ω–µ–µ —á—É—Ç–∫–æ–º—É –ø–æ–¥—Ö–æ–¥—É –∫ –¥–µ–ª–∏–∫–∞—Ç–Ω—ã–º –¥—É—Ö–æ–≤–Ω—ã–º –≤–æ–ø—Ä–æ—Å–∞–º. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ—Ä–∂–∞—Ç—å –≤–∫–ª—é—á–µ–Ω–Ω—ã–º –¥–ª—è –¥—É—Ö–æ–≤–Ω–æ–π —Ç–µ–º–∞—Ç–∏–∫–∏.',
    },
    {
      param: 'context_max_length',
      description:
        '–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —Å–∏–º–≤–æ–ª–∞—Ö',
      help_text:
        '–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –æ–±—â–∏–π –æ–±—ä–µ–º —Ç–µ–∫—Å—Ç–∞ –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞. –ú–∞–ª—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (1000-3000) —É—Å–∫–æ—Ä—è—é—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∏ —Å–Ω–∏–∂–∞—é—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å, –Ω–æ –º–æ–≥—É—Ç –æ–±—Ä–µ–∑–∞—Ç—å –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (4000-8000) –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å. –ë–æ–ª—å—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (9000+) –ø–æ–∑–≤–æ–ª—è—é—Ç –≤–∫–ª—é—á–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞, –Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –≤—Ä–µ–º—è –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏.\n\n–î–ª—è –≥–ª—É–±–æ–∫–∏—Ö –¥—É—Ö–æ–≤–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 6000-8000 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –ø–æ–ª–Ω–æ—Ç—ã –æ—Å–≤–µ—â–µ–Ω–∏—è —Ç–µ–º—ã.',
    },
    {
      param: 'chunk_size',
      description:
        '–†–∞–∑–º–µ—Ä —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ —Ä–∞–∑–±–∏–µ–Ω–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏',
      help_text:
        '–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞ —Å–∫–æ–ª—å–∫–æ —Å–∏–º–≤–æ–ª–æ–≤ —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π. –ú–∞–ª—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã (200-500) –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–æ –º–æ–≥—É—Ç —Ç–µ—Ä—è—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç. –°—Ä–µ–¥–Ω–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã (800-1200) —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ç–æ—á–Ω–æ—Å—Ç—å—é –ø–æ–∏—Å–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –ë–æ–ª—å—à–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã (1500+) –ª—É—á—à–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å–º—ã—Å–ª, –Ω–æ –º–æ–≥—É—Ç —Å–Ω–∏–∂–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞.\n\n–î–ª—è –¥—É—Ö–æ–≤–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 1000-1200 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –∏–¥–µ–π –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.',
    },
    {
      param: 'chunk_overlap',
      description:
        '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏ —Ç–µ–∫—Å—Ç–∞',
      help_text:
        '–°–æ–∑–¥–∞–µ—Ç –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö —Ä–∞–∑–±–∏–µ–Ω–∏—è. –ë–µ–∑ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è (0) –≤–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç —Ç–µ—Ä—è—Ç—å—Å—è –Ω–∞ —Å—Ç—ã–∫–∞—Ö —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤. –ú–∞–ª–æ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ (50-100) –º–∏–Ω–∏–º–∞–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤—è–∑–Ω–æ—Å—Ç—å. –°—Ä–µ–¥–Ω–µ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ (150-250) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ö–æ—Ä–æ—à–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞. –ë–æ–ª—å—à–æ–µ –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ (300+) –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤—è–∑–∏, –Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –æ–±—ä–µ–º –¥–∞–Ω–Ω—ã—Ö.\n\n–î–ª—è –¥—É—Ö–æ–≤–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 200-250 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∞–∂–Ω—ã—Ö —Å–º—ã—Å–ª–æ–≤—ã—Ö —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –∞–±–∑–∞—Ü–∞–º–∏.',
    },
    {
      param: 'use_mock',
      description:
        '–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–∏–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö API',
      help_text:
        '–ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—Ç–ª–∞–¥–∫–∏ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö API OpenAI. –í —ç—Ç–æ–º —Ä–µ–∂–∏–º–µ —Å–∏—Å—Ç–µ–º–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, –∏–º–∏—Ç–∏—Ä—É—è —Ä–∞–±–æ—Ç—É —Å –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ AI –º–æ–¥–µ–ª—å—é. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∏ —ç–∫–æ–Ω–æ–º–∏–∏ API-–∫—Ä–µ–¥–∏—Ç–æ–≤ –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.\n\n–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω-—Ä–µ–∂–∏–º–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ —ç—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç AI.',
    },
    {
      param: 'system_prompt',
      description: '–û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è –¥–ª—è AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞',
      help_text:
        '–ë–∞–∑–æ–≤—ã–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ª–∏—á–Ω–æ—Å—Ç—å, —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è –∏ —ç—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞. –≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –º–æ–¥–µ–ª–∏ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤—É –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã. –ó–¥–µ—Å—å –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Ä–æ–ª—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ (–¥—É—Ö–æ–≤–Ω—ã–π –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫), –ø—Ä–∏–Ω—Ü–∏–ø—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (—Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏–µ, –º—É–¥—Ä–æ—Å—Ç—å, —É–≤–∞–∂–µ–Ω–∏–µ), —ç—Ç–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø–æ–¥—Ö–æ–¥ –∫ –æ—Ç–≤–µ—Ç–∞–º.\n\n–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ö–∞—Ä–∞–∫—Ç–µ—Ä –æ—Ç–≤–µ—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏–∑–º–µ–Ω—è—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.',
    },
  ]

  for (const desc of enhancedDescriptions) {
    try {
      const result = database
        .prepare(
          'UPDATE system_settings SET description = ?, help_text = ? WHERE parameter_name = ?'
        )
        .run(desc.description, desc.help_text, desc.param)

      if (result.changes > 0) {
        console.log(`üìù –û–±–Ω–æ–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è: ${desc.param}`)
      }
    } catch (error) {
      console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –æ–ø–∏—Å–∞–Ω–∏—è ${desc.param}:`, error)
    }
  }

  console.log('\n‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!')
  console.log('\nüìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫:')

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
  const finalStructure = database
    .prepare(
      `
      SELECT category, parameter_name, display_name 
      FROM system_settings 
      ORDER BY category, ui_order, parameter_name
    `
    )
    .all()

  let currentCategory = ''
  for (const setting of finalStructure) {
    if (setting.category !== currentCategory) {
      console.log(`\nüîß ${setting.category.toUpperCase()}:`)
      currentCategory = setting.category
    }
    console.log(`   ‚Ä¢ ${setting.display_name}`)
  }
}

// –ó–∞–ø—É—Å–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
fixDuplicateSettings().catch((error) => {
  console.error('‚ùå –û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:', error)
  process.exit(1)
})
